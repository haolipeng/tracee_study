# eBPF å®‰å…¨æ£€æµ‹å·¥å…·å¼€å‘å­¦ä¹ è·¯å¾„

> æœ¬æ–‡æ¡£é’ˆå¯¹ã€Œè‡ªä¸»å¼€å‘ eBPF å®‰å…¨æ£€æµ‹å·¥å…·ã€ç›®æ ‡è®¾è®¡ï¼Œé‡‡ç”¨**ç›®æ ‡é©±åŠ¨ã€å®è·µä¼˜å…ˆ**çš„å­¦ä¹ æ–¹å¼ã€‚

---

## å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬å­¦ä¹ è·¯å¾„åï¼Œä½ å°†èƒ½å¤Ÿï¼š

1. ç‹¬ç«‹å¼€å‘ä¸€ä¸ªç®€å•çš„ eBPF å®‰å…¨æ£€æµ‹å·¥å…·
2. åŸºäº Tracee çš„è®¾è®¡æ€æƒ³è®¾è®¡è‡ªå·±çš„æ£€æµ‹æ¶æ„
3. ä»æ”»å‡»æ‰‹æ³•æ¨å¯¼å‡ºæ£€æµ‹é€»è¾‘å¹¶å®ç°
4. ä¸ºæ£€æµ‹äº‹ä»¶æ·»åŠ è¿›ç¨‹/å®¹å™¨ä¸Šä¸‹æ–‡ä¿¡æ¯

---

## å‰ç½®æ¡ä»¶

| æ¡ä»¶ | è¯´æ˜ |
|------|------|
| Linux è™šæ‹Ÿæœº | å†…æ ¸ç‰ˆæœ¬ 5.4+ï¼Œæ¨è Ubuntu 20.04/22.04 |
| å·²éƒ¨ç½² Tracee | ç”¨äºå‚è€ƒå’ŒéªŒè¯æ£€æµ‹æ•ˆæœ |
| Go è¯­è¨€åŸºç¡€ | èƒ½è¯»æ‡‚å’Œç¼–å†™åŸºæœ¬çš„ Go ä»£ç  |
| åŸºæœ¬çš„ Linux å‘½ä»¤ | cdã€lsã€catã€chmod ç­‰ |

---

## å­¦ä¹ è·¯å¾„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å­¦ä¹ è·¯å¾„ï¼ˆ8-10 å‘¨ï¼‰                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é˜¶æ®µ 1                é˜¶æ®µ 2                é˜¶æ®µ 3              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ åŸºç¡€é“ºå«  â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ ææƒæ£€æµ‹  â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ æ–‡ä»¶ç›‘æ§  â”‚        â”‚
â”‚  â”‚ (1 å‘¨)   â”‚         â”‚ (2 å‘¨)   â”‚         â”‚ (1 å‘¨)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚                    â”‚                    â”‚              â”‚
â”‚       â–¼                    â–¼                    â–¼              â”‚
â”‚  ç¬¬ä¸€ä¸ª eBPF          æ£€æµ‹ UID å˜åŒ–        æ£€æµ‹æ•æ„Ÿæ–‡ä»¶è®¿é—®       â”‚
â”‚  ç¨‹åºè¿è¡ŒæˆåŠŸ          (commit_creds)       (/etc/shadow)       â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é˜¶æ®µ 4                é˜¶æ®µ 5                é˜¶æ®µ 6              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ ä¸Šä¸‹æ–‡ä¸°å¯Œ â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ æ¶æ„è®¾è®¡  â”‚ â”€â”€â”€â”€â”€â”€â–¶ â”‚ è¿›é˜¶æ‰©å±•  â”‚        â”‚
â”‚  â”‚ (2 å‘¨)   â”‚         â”‚ (2 å‘¨)   â”‚         â”‚ (æŒç»­)   â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚                    â”‚                    â”‚              â”‚
â”‚       â–¼                    â–¼                    â–¼              â”‚
â”‚  è¿›ç¨‹æ ‘ + å®¹å™¨ä¿¡æ¯     æ•´åˆä¸ºå®Œæ•´å·¥å…·        æ›´å¤šæ£€æµ‹è§„åˆ™          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é˜¶æ®µ 1ï¼šåŸºç¡€é“ºå«ï¼ˆç¬¬ 1 å‘¨ï¼‰

### å­¦ä¹ ç›®æ ‡

- ç†è§£ eBPF æ˜¯ä»€ä¹ˆã€èƒ½åšä»€ä¹ˆ
- è¿è¡Œç¬¬ä¸€ä¸ª eBPF ç¨‹åº
- ç†è§£ kprobeã€tracepoint ç­‰æ¢é’ˆç±»å‹

### å­¦ä¹ å†…å®¹

| é¡ºåº | å†…å®¹ | æ–‡æ¡£ | æ—¶é—´ |
|------|------|------|------|
| 1 | æ ¸å¿ƒæ¦‚å¿µé€šä¿—è§£é‡Š | [concepts-explained.md](concepts-explained.md) | 2h |
| 2 | eBPF åŸºç¡€æ¦‚å¿µ | [ebpf-practice/00-overview.md](ebpf-practice/00-overview.md) | 3h |
| 3 | æ¢é’ˆç±»å‹å¯¹æ¯” | [ebpf-probe-types.md](ebpf-probe-types.md) ç¬¬1-2èŠ‚ | 2h |

### åŠ¨æ‰‹å®éªŒ

**å®éªŒ 1.1ï¼šè¿è¡Œ hello-exec**

```bash
# ç›®æ ‡ï¼šæ•è· execve ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰“å°æ‰§è¡Œçš„å‘½ä»¤

# 1. è¿›å…¥ Tracee æºç ç›®å½•
cd /path/to/tracee

# 2. è¿è¡Œ Tracee åªç›‘æ§ execve äº‹ä»¶
sudo ./dist/tracee --events execve

# 3. åœ¨å¦ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œå‘½ä»¤ï¼Œè§‚å¯Ÿè¾“å‡º
ls
cat /etc/passwd
```

**å®éªŒ 1.2ï¼šç†è§£äº‹ä»¶è¾“å‡º**

è§‚å¯Ÿ Tracee è¾“å‡ºçš„äº‹ä»¶ç»“æ„ï¼š
- æ—¶é—´æˆ³
- è¿›ç¨‹ä¿¡æ¯ï¼ˆPIDã€PPIDã€commï¼‰
- å®¹å™¨ä¿¡æ¯ï¼ˆå¦‚æœ‰ï¼‰
- äº‹ä»¶å‚æ•°

### é˜¶æ®µäº§å‡º

- [ ] èƒ½è¿è¡Œ Tracee å¹¶æ•è· execve äº‹ä»¶
- [ ] ç†è§£ eBPF ç¨‹åºçš„åŸºæœ¬ç»“æ„
- [ ] ç†è§£ kprobe å’Œ tracepoint çš„åŒºåˆ«

### æ£€æŸ¥ç‚¹

å›ç­”ä»¥ä¸‹é—®é¢˜ï¼ˆæ£€éªŒç†è§£ç¨‹åº¦ï¼‰ï¼š

1. eBPF ç¨‹åºè¿è¡Œåœ¨å“ªé‡Œï¼Ÿï¼ˆç”¨æˆ·æ€/å†…æ ¸æ€ï¼‰
2. kprobe å’Œ tracepoint çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ
3. eBPF ç¨‹åºå¦‚ä½•å°†æ•°æ®ä¼ é€’ç»™ç”¨æˆ·æ€ï¼Ÿ

---

## é˜¶æ®µ 2ï¼šææƒæ£€æµ‹ï¼ˆç¬¬ 2-3 å‘¨ï¼‰

### å­¦ä¹ ç›®æ ‡

- ç†è§£ Linux æƒé™æ¨¡å‹ï¼ˆUIDã€cred ç»“æ„ï¼‰
- ç†è§£æœ¬åœ°ææƒçš„æ”»å‡»åŸç†
- å®ç° UID å˜åŒ–æ£€æµ‹ï¼ˆcommit_creds hookï¼‰

### å­¦ä¹ å†…å®¹

| é¡ºåº | å†…å®¹ | æ–‡æ¡£ | æ—¶é—´ |
|------|------|------|------|
| 1 | Linux æƒé™æ¨¡å‹ | [concepts-explained.md](concepts-explained.md) ç¬¬2èŠ‚ | 1h |
| 2 | æœ¬åœ°ææƒæ”»å‡»åŸç† | [local-privilege-escalation-attacks.md](local-privilege-escalation-attacks.md) | 3h |
| 3 | ææƒæ£€æµ‹åŸç† | [local-privilege-escalation-detection.md](local-privilege-escalation-detection.md) | 3h |
| 4 | ææƒæ”»é˜²å®éªŒ | [lab-01-privilege-escalation.md](lab-01-privilege-escalation.md) | 6h |

### åŠ¨æ‰‹å®éªŒ

**å®éªŒ 2.1ï¼šå¤ç° SUID ææƒ**

è¯¦è§ [lab-01-privilege-escalation.md](lab-01-privilege-escalation.md)

```bash
# ç®€è¦æ­¥éª¤é¢„è§ˆ
# 1. ç»™ find å‘½ä»¤è®¾ç½® SUID ä½
sudo chmod u+s /usr/bin/find

# 2. æ™®é€šç”¨æˆ·åˆ©ç”¨ find æ‰§è¡Œ root å‘½ä»¤
find /etc/passwd -exec whoami \;

# 3. è§‚å¯Ÿ Tracee æ£€æµ‹ç»“æœ
```

**å®éªŒ 2.2ï¼šç¼–å†™ commit_creds æ£€æµ‹**

è¯¦è§ [lab-01-privilege-escalation.md](lab-01-privilege-escalation.md)

æ ¸å¿ƒæ€è·¯ï¼š
1. Hook `commit_creds` å‡½æ•°
2. è·å–æ–°æ—§å‡­è¯çš„ UID/EUID
3. æ£€æµ‹æ˜¯å¦ä»é 0 å˜ä¸º 0
4. è§¦å‘å‘Šè­¦

### é˜¶æ®µäº§å‡º

- [ ] èƒ½å¤ç° SUID ææƒæ”»å‡»
- [ ] ç†è§£ commit_creds ä¸ºä»€ä¹ˆæ˜¯æ£€æµ‹ææƒçš„æœ€ä½³ hook ç‚¹
- [ ] èƒ½ç¼–å†™ç®€å•çš„ UID å˜åŒ–æ£€æµ‹ eBPF ç¨‹åº

### æ£€æŸ¥ç‚¹

1. ä¸ºä»€ä¹ˆ hook commit_creds æ¯” hook setuid ç³»ç»Ÿè°ƒç”¨æ›´å¥½ï¼Ÿ
2. å¦‚ä½•åŒºåˆ†æ­£å¸¸çš„ sudo ææƒå’Œæ¶æ„ææƒï¼Ÿ
3. struct cred ä¸­å“ªäº›å­—æ®µä¸æƒé™æ£€æµ‹æœ€ç›¸å…³ï¼Ÿ

---

## é˜¶æ®µ 3ï¼šæ•æ„Ÿæ–‡ä»¶ç›‘æ§ï¼ˆç¬¬ 4 å‘¨ï¼‰

### å­¦ä¹ ç›®æ ‡

- ç†è§£æ–‡ä»¶è®¿é—®ç›¸å…³çš„ hook ç‚¹
- å®ç°æ•æ„Ÿæ–‡ä»¶è®¿é—®æ£€æµ‹
- å­¦ä¼šè®¾è®¡æ–‡ä»¶è·¯å¾„è¿‡æ»¤è§„åˆ™

### å­¦ä¹ å†…å®¹

| é¡ºåº | å†…å®¹ | æ–‡æ¡£ | æ—¶é—´ |
|------|------|------|------|
| 1 | LSM Hook ä»‹ç» | [ebpf-probe-types.md](ebpf-probe-types.md) ç¬¬4èŠ‚ | 1h |
| 2 | Tracee ç­¾åå®ç°åˆ†æ | [signature-engine.md](signature-engine.md) ç¬¬5èŠ‚ | 2h |
| 3 | æ–‡ä»¶ç›‘æ§å®éªŒ | [lab-02-sensitive-file-access.md](lab-02-sensitive-file-access.md) | 4h |

### åŠ¨æ‰‹å®éªŒ

**å®éªŒ 3.1ï¼šæ£€æµ‹ /etc/shadow è¯»å–**

```bash
# ä½¿ç”¨ Tracee ç›‘æ§
sudo ./dist/tracee --events security_file_open \
    --filter 'event.args.pathname=/etc/shadow'

# åœ¨å¦ä¸€ç»ˆç«¯è§¦å‘
cat /etc/shadow
```

**å®éªŒ 3.2ï¼šè‡ªå·±å®ç°æ–‡ä»¶è®¿é—®æ£€æµ‹**

è¯¦è§ [lab-02-sensitive-file-access.md](lab-02-sensitive-file-access.md)

æ ¸å¿ƒæ€è·¯ï¼š
1. Hook `security_file_open` æˆ– `vfs_read`
2. è·å–æ–‡ä»¶è·¯å¾„
3. åŒ¹é…æ•æ„Ÿæ–‡ä»¶åˆ—è¡¨
4. è¾“å‡ºå‘Šè­¦

### é˜¶æ®µäº§å‡º

- [ ] ç†è§£ security_file_open ç­‰ LSM hook
- [ ] èƒ½æ£€æµ‹æŒ‡å®šæ–‡ä»¶çš„è¯»/å†™æ“ä½œ
- [ ] ç†è§£ BPF Maps åœ¨è·¯å¾„åŒ¹é…ä¸­çš„åº”ç”¨

---

## é˜¶æ®µ 4ï¼šä¸Šä¸‹æ–‡ä¸°å¯Œï¼ˆç¬¬ 5-6 å‘¨ï¼‰

### å­¦ä¹ ç›®æ ‡

- è·å–å®Œæ•´çš„è¿›ç¨‹ä¿¡æ¯ï¼ˆPIDã€PPIDã€è¿›ç¨‹é“¾ï¼‰
- åˆ¤æ–­äº‹ä»¶æ˜¯å¦æ¥è‡ªå®¹å™¨
- è®¾è®¡é«˜æ•ˆçš„ç¼“å­˜æœºåˆ¶

### å­¦ä¹ å†…å®¹

| é¡ºåº | å†…å®¹ | æ–‡æ¡£ | æ—¶é—´ |
|------|------|------|------|
| 1 | è¿›ç¨‹æ ‘æœºåˆ¶ | [proctree-and-cache.md](proctree-and-cache.md) | 3h |
| 2 | å®¹å™¨é›†æˆ | [06-container-integration.md](06-container-integration.md) ç¬¬1-3èŠ‚ | 3h |
| 3 | BPF Maps è®¾è®¡ | [bpf-maps-deep-dive.md](bpf-maps-deep-dive.md) | 4h |

### åŠ¨æ‰‹å®éªŒ

**å®éªŒ 4.1ï¼šè·å–è¿›ç¨‹ä¸Šä¸‹æ–‡**

```c
// åœ¨ eBPF ç¨‹åºä¸­è·å–è¿›ç¨‹ä¿¡æ¯
struct task_struct *task = (struct task_struct *)bpf_get_current_task();

// è¯»å– PID
u32 pid = bpf_get_current_pid_tgid() >> 32;

// è¯»å–è¿›ç¨‹å
char comm[16];
bpf_get_current_comm(&comm, sizeof(comm));

// è¯»å–çˆ¶è¿›ç¨‹ PID
u32 ppid;
bpf_probe_read_kernel(&ppid, sizeof(ppid), &task->real_parent->tgid);
```

**å®éªŒ 4.2ï¼šåˆ¤æ–­æ˜¯å¦æ¥è‡ªå®¹å™¨**

```c
// é€šè¿‡ cgroup ID åˆ¤æ–­
u64 cgroup_id = bpf_get_current_cgroup_id();

// æˆ–é€šè¿‡ namespace åˆ¤æ–­
// è¯»å– task->nsproxy->mnt_ns->ns.inum
```

### é˜¶æ®µäº§å‡º

- [ ] èƒ½åœ¨äº‹ä»¶ä¸­æ·»åŠ å®Œæ•´çš„è¿›ç¨‹ä¸Šä¸‹æ–‡
- [ ] èƒ½åˆ¤æ–­äº‹ä»¶æ˜¯å¦æ¥è‡ªå®¹å™¨
- [ ] ç†è§£ BPF Maps çš„å„ç§ç±»å‹å’Œä½¿ç”¨åœºæ™¯

---

## é˜¶æ®µ 5ï¼šæ¶æ„è®¾è®¡ï¼ˆç¬¬ 7-8 å‘¨ï¼‰

### å­¦ä¹ ç›®æ ‡

- ç†è§£ Tracee çš„æ¶æ„è®¾è®¡æ€æƒ³
- è®¾è®¡äº‹ä»¶å¤„ç†æµæ°´çº¿
- æ•´åˆå‰é¢çš„æ¨¡å—ä¸ºå®Œæ•´å·¥å…·

### å­¦ä¹ å†…å®¹

| é¡ºåº | å†…å®¹ | æ–‡æ¡£ | æ—¶é—´ |
|------|------|------|------|
| 1 | Tracee æ¶æ„æ¦‚è§ˆ | [01-architecture-overview.md](01-architecture-overview.md) | 3h |
| 2 | äº‹ä»¶æµæ°´çº¿ | [02-event-pipeline.md](02-event-pipeline.md) | 4h |
| 3 | æ£€æµ‹è®¾è®¡æ–¹æ³•è®º | [detection-design-methodology.md](detection-design-methodology.md) | 2h |
| 4 | ä»é›¶æ­å»ºæ•™ç¨‹ | [tutorial-ebpf-detector-from-scratch.md](tutorial-ebpf-detector-from-scratch.md) | 8h |

### åŠ¨æ‰‹å®éªŒ

**å®éªŒ 5.1ï¼šè®¾è®¡ä½ çš„æ£€æµ‹å·¥å…·æ¶æ„**

```
ä½ çš„ mini-detector æ¶æ„ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç”¨æˆ·ç©ºé—´                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ äº‹ä»¶æ¥æ”¶ â”‚â”€â–¶â”‚ è§„åˆ™åŒ¹é… â”‚â”€â–¶â”‚ è¾“å‡º/å‘Šè­¦   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚       â–²                                     â”‚
â”‚       â”‚ perf buffer / ring buffer           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       â”‚           å†…æ ¸ç©ºé—´                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ææƒæ£€æµ‹ â”‚  â”‚ æ–‡ä»¶ç›‘æ§  â”‚  â”‚ ä¸Šä¸‹æ–‡è·å– â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®éªŒ 5.2ï¼šæ•´åˆä¸ºå®Œæ•´å·¥å…·**

æ•´åˆé˜¶æ®µ 2-4 çš„ä»£ç ï¼Œå®ç°ä¸€ä¸ªåŒ…å«ä»¥ä¸‹åŠŸèƒ½çš„å·¥å…·ï¼š
1. ææƒæ£€æµ‹
2. æ•æ„Ÿæ–‡ä»¶è®¿é—®æ£€æµ‹
3. è¿›ç¨‹ä¸Šä¸‹æ–‡
4. JSON æ ¼å¼è¾“å‡º

### é˜¶æ®µäº§å‡º

- [ ] ç†è§£ Tracee çš„è®¾è®¡ç†å¿µ
- [ ] å®Œæˆ mini-detector å·¥å…·å¼€å‘
- [ ] èƒ½ç‹¬ç«‹è®¾è®¡æ£€æµ‹å·¥å…·æ¶æ„

---

## é˜¶æ®µ 6ï¼šè¿›é˜¶æ‰©å±•ï¼ˆç¬¬ 9 å‘¨+ï¼‰

### å¯é€‰æ–¹å‘

| æ–¹å‘ | å†…å®¹ | æ–‡æ¡£ |
|------|------|------|
| å®¹å™¨é€ƒé€¸æ£€æµ‹ | æ£€æµ‹ cgroup é€ƒé€¸ã€Docker Socket æ»¥ç”¨ç­‰ | [lab-03-container-escape.md](lab-03-container-escape.md) |
| ç½‘ç»œç›‘æ§ | æ£€æµ‹å¯ç–‘ç½‘ç»œè¿æ¥ | [network-events.md](network-events.md) |
| ç­–ç•¥å¼•æ“ | å®ç°å¯é…ç½®çš„æ£€æµ‹è§„åˆ™ | [05-policy-engine.md](05-policy-engine.md) |
| æ€§èƒ½ä¼˜åŒ– | Per-CPU Mapsã€æ‰¹é‡å¤„ç†ç­‰ | [bpf-maps-deep-dive.md](bpf-maps-deep-dive.md) |

---

## å­¦ä¹ èµ„æºå¿«é€Ÿç´¢å¼•

### æŒ‰ä¸»é¢˜æŸ¥æ‰¾

| ä¸»é¢˜ | æ¨èæ–‡æ¡£ |
|------|----------|
| eBPF åŸºç¡€ | concepts-explained.md â†’ ebpf-practice/00-overview.md |
| ææƒæ£€æµ‹ | local-privilege-escalation-*.md â†’ lab-01 |
| æ–‡ä»¶ç›‘æ§ | lab-02-sensitive-file-access.md |
| è¿›ç¨‹ä¸Šä¸‹æ–‡ | proctree-and-cache.md |
| å®¹å™¨ä¿¡æ¯ | 06-container-integration.md |
| BPF Maps | bpf-maps-deep-dive.md |
| æ¶æ„è®¾è®¡ | 01-architecture-overview.md â†’ 02-event-pipeline.md |
| ç­¾åå¼€å‘ | signature-engine.md |

### æŒ‰éš¾åº¦æŸ¥æ‰¾

| éš¾åº¦ | æ–‡æ¡£ |
|------|------|
| å…¥é—¨ | concepts-explained.mdã€lab-01ã€lab-02 |
| ä¸­çº§ | 03-ebpf-implementation.mdã€proctree-and-cache.md |
| è¿›é˜¶ | bpf-maps-deep-dive.mdã€signature-engine.md |

---

## å¸¸è§é—®é¢˜

### Q1ï¼šæ²¡æœ‰ C è¯­è¨€åŸºç¡€èƒ½å­¦å—ï¼Ÿ

å¯ä»¥ï¼Œä½†å»ºè®®å…ˆèŠ± 1-2 å¤©äº†è§£ C è¯­è¨€åŸºç¡€ï¼ˆæŒ‡é’ˆã€ç»“æ„ä½“ï¼‰ã€‚eBPF ç¨‹åºé€šå¸¸å¾ˆçŸ­ï¼Œæ ¸å¿ƒæ˜¯ç†è§£æ¦‚å¿µè€Œéå¤æ‚è¯­æ³•ã€‚

### Q2ï¼šå­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜æ€ä¹ˆåŠï¼Ÿ

1. æŸ¥çœ‹ Tracee æºç ä¸­çš„ç±»ä¼¼å®ç°
2. ä½¿ç”¨ `bpftool` è°ƒè¯• eBPF ç¨‹åº
3. æŸ¥çœ‹å†…æ ¸æ–‡æ¡£å’Œ eBPF ç¤¾åŒºèµ„æº

### Q3ï¼šå®Œæˆå­¦ä¹ è·¯å¾„åèƒ½åšä»€ä¹ˆï¼Ÿ

- ä¸º Tracee è´¡çŒ®æ–°çš„æ£€æµ‹ç­¾å
- å¼€å‘è‡ªå·±çš„å®‰å…¨æ£€æµ‹å·¥å…·
- åœ¨å·¥ä½œä¸­åº”ç”¨ eBPF æŠ€æœ¯è¿›è¡Œå®‰å…¨ç›‘æ§

---

## å¼€å§‹å­¦ä¹ 

å‡†å¤‡å¥½äº†å—ï¼Ÿä»ç¬¬ä¸€æ­¥å¼€å§‹ï¼š

ğŸ‘‰ **[é˜¶æ®µ 1ï¼šæ ¸å¿ƒæ¦‚å¿µé€šä¿—è§£é‡Š](concepts-explained.md)**

---

_æœ€åæ›´æ–°ï¼š2026-02-15_
